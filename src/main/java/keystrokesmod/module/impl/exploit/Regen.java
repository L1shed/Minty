package keystrokesmod.module.impl.exploit;

import keystrokesmod.event.PreMotionEvent;
import keystrokesmod.module.Module;
import keystrokesmod.module.setting.impl.ButtonSetting;
import keystrokesmod.module.setting.impl.SliderSetting;
import keystrokesmod.utility.PacketUtils;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

public class Regen extends Module {
    private final SliderSetting speed;
    private final SliderSetting minHealth;
    private final ButtonSetting notInAir;
    private final ButtonSetting groundSpoof;

    public Regen() {
        super("Regen", category.exploit);
        this.registerSetting(speed = new SliderSetting("Speed", 10, 1, 200, 1, "x"));
        this.registerSetting(minHealth = new SliderSetting("Min health", 15, 5, 40, 1));
        this.registerSetting(notInAir = new ButtonSetting("Not in air", false));
        this.registerSetting(groundSpoof = new ButtonSetting("Ground spoof", false));
    }

    @SubscribeEvent
    public void onPreMotion(PreMotionEvent event) {
        if (mc.thePlayer.getHealth() > minHealth.getInput()) return;
        if (notInAir.isToggled() && !mc.thePlayer.onGround) return;

        for (int i = 0; i < speed.getInput(); i++) {
            if (groundSpoof.isToggled()) {
                PacketUtils.sendPacket(new C03PacketPlayer(true));
            } else {
                PacketUtils.sendPacket(new C03PacketPlayer(event.isOnGround()));
            }
        }
    }
}
